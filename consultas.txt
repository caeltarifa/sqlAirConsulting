/*Selecciona Todos los Alpha Notam nuevos vigentes*/
select aftn1,aftn2,idnotam,resumen,valido_desde,valido_desde,
to_timestamp(tablax.tiempo_valido_desde, 'YYMMDDHH24MI') as tiempo_desde,
valido_hasta,
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') as tiempo_hasta
from
(select aftn1,aftn2,idnotam,resumen,valido_desde,
substring(valido_desde FROM 3) as tiempo_valido_desde,valido_hasta,
substring(valido_hasta FROM 3) as tiempo_valido_hasta
from plan_vuelo_notam_trafico where length(valido_hasta) >4) as tablax
where
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') > NOW()::timestamp
and idnotam LIKE '(%NOTAMN%' and idnotam LIKE '(A%' order by tiempo_hasta;

/*Selecciona Todos los Alpha Notam Reemplazados vigentes*/
select aftn1,aftn2,idnotam,resumen,valido_desde,valido_desde,
to_timestamp(tablax.tiempo_valido_desde, 'YYMMDDHH24MI') as tiempo_desde,
valido_hasta,
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') as tiempo_hasta
from
(select aftn1,aftn2,idnotam,resumen,valido_desde,
substring(valido_desde FROM 3) as tiempo_valido_desde,valido_hasta,
substring(valido_hasta FROM 3) as tiempo_valido_hasta
from plan_vuelo_notam_trafico where length(valido_hasta) >4) as tablax
where
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') > NOW()::timestamp
and idnotam LIKE '(%NOTAMR%' and idnotam LIKE '(A%' order by tiempo_hasta;

/*Selecciona Todos los Alpha Notam Cambiados vigentes*/
select aftn1,aftn2,idnotam,resumen,valido_desde,valido_desde,
to_timestamp(tablax.tiempo_valido_desde, 'YYMMDDHH24MI') as tiempo_desde,
valido_hasta,
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') as tiempo_hasta
from
(select aftn1,aftn2,idnotam,resumen,valido_desde,
substring(valido_desde FROM 3) as tiempo_valido_desde,valido_hasta,
substring(valido_hasta FROM 3) as tiempo_valido_hasta
from plan_vuelo_notam_trafico where length(valido_hasta) >4) as tablax
where
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') > NOW()::timestamp
and idnotam LIKE '(%NOTAMC%' and idnotam LIKE '(A%' order by tiempo_hasta;

/*Selecciona Todos los Charlies Notam nuevos vigentes*/
select aftn1,aftn2,idnotam,resumen,valido_desde,valido_desde,
to_timestamp(tablax.tiempo_valido_desde, 'YYMMDDHH24MI') as tiempo_desde,
valido_hasta,
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') as tiempo_hasta
from
(select aftn1,aftn2,idnotam,resumen,valido_desde,
substring(valido_desde FROM 3) as tiempo_valido_desde,valido_hasta,
substring(valido_hasta FROM 3) as tiempo_valido_hasta
from plan_vuelo_notam_trafico where length(valido_hasta) >4) as tablax
where
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') > NOW()::timestamp
and idnotam LIKE '(%NOTAMN%' and idnotam LIKE '(C%' order by tiempo_hasta;

/*Selecciona Todos los Charlies Notam Reemplazados vigentes*/
select aftn1,aftn2,idnotam,resumen,valido_desde,valido_desde,
to_timestamp(tablax.tiempo_valido_desde, 'YYMMDDHH24MI') as tiempo_desde,
valido_hasta,
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') as tiempo_hasta
from
(select aftn1,aftn2,idnotam,resumen,valido_desde,
substring(valido_desde FROM 3) as tiempo_valido_desde,valido_hasta,
substring(valido_hasta FROM 3) as tiempo_valido_hasta
from plan_vuelo_notam_trafico where length(valido_hasta) >4) as tablax
where
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') > NOW()::timestamp
and idnotam LIKE '(%NOTAMR%' and idnotam LIKE '(C%' order by tiempo_hasta;

/*Selecciona Todos los Charlies Notam Cambiados vigentes*/
select aftn1,aftn2,idnotam,resumen,valido_desde,valido_desde,
to_timestamp(tablax.tiempo_valido_desde, 'YYMMDDHH24MI') as tiempo_desde,
valido_hasta,
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') as tiempo_hasta
from
(select aftn1,aftn2,idnotam,resumen,valido_desde,
substring(valido_desde FROM 3) as tiempo_valido_desde,valido_hasta,
substring(valido_hasta FROM 3) as tiempo_valido_hasta
from plan_vuelo_notam_trafico where length(valido_hasta) >4) as tablax
where
to_timestamp(tablax.tiempo_valido_hasta, 'YYMMDDHH24MI') > NOW()::timestamp
and idnotam LIKE '(%NOTAMC%' and idnotam LIKE '(C%' order by tiempo_hasta;